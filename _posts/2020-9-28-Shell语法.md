---
categories:
- Linux
- Shell
last-updated-date: 2021-09-01 20:27:53 +0800
layout: post
---

# Bash

脚本第一行`#!<shell path>`指定用哪个shell来执行该脚本

如果要用逻辑运算符`&&`或`||`就要用双方括号`[[]]`围住，单方括号`[]`会报语法错误

双方括号`[[]]`中自定义变量可以直接写`$var`，单方括号`[]`中的变量必须要加上双引号`"$var"`

全局变量？？？

## 函数

函数获取返回值`$(function name)`

## 参数

判断是否传入参数（参数是否存在）：直接`$1`

## 条件表达式

条件表达式要放在方括号之间

## 文件运算符

`-e`文件存在

`-d`文件存在&是目录

`-f`文件存在&是普通文件（非目录或设备文件）

## 空格

赋值`=`两边不能有空格，判断相等`=`两边必须要有空格

## 参数扩展

Parameter Expansion

`${parameter:-word}`：*使用*默认值，如果`parameter`不存在，就以`word`作为其值

详情参考：`man bash`

# Zsh和Bash的兼容性问题

Zsh并不是完全兼容Bash

如果要**完全兼容**，使用`emulate bash` 或文件开头添加`#!/usr/bin/bash`（直接指定用bash执行该脚本）

目前遇到的不兼容情况：

1. 条件表达式中，判断相等，Bash支持双等号`==`，而Zsh只支持单等号`=`
2. curl命令无法正常运行

Shell中的**字符串变量**更像是C语言中的宏定义，运行时直接替换到目标位置，如果包含空格就容易引起歧义，因此通常将变量写在双引号内`"$a"`。

算数运算在((...))中进行，如`((i=i+1))`

# 运算符

`-z`字符串长度为0返回true

`-n`字符串长度**不**为0返回true

# 上一条命令返回值

`$?`

# if

`if [[ 0 ]]` 也会判断为真，并执行if中的内容

# 管道命令执行顺序

用管道连接的命令是**同时**执行的

比如`ps a | grep bash`的执行结果中，会出现`grep`的进程

```shell
➜  ~ ps a | grep bash
  263 pts/0    Ss     0:00 -bash
  811 pts/0    S+     0:00 grep bash
```

说明在`ps`在执行打印进程信息的时候，`grep`也在执行了，也就是说`ps`和`grep`是同时执行的

只不过`grep`执行到需要输入的时候就会停下来(状态S+)，等待I/O（`ps`的标准输出）