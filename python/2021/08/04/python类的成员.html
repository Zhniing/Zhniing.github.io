<!DOCTYPE html>
<html>
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Python类的成员</title>
    <script type="text/javascript" src="/assets/js/prism.js"></script>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/prism.css">
    <script type="text/javascript" src="/assets/js/jquery-3.6.0.js"></script>
    <script src="/assets/js/scrollnav.min.umd.js"></script>
  </head>
  <body>
    <div class="wrapper">
      <div class="clearfloat">
        <nav class="navbar">
    <!-- <a href="/" >
        Home
    </a>
    <a href="/about.html" >
        About
    </a> -->
    
        <!-- <a href="https://github.com/Zhniing"  target="_self"> -->
        <a href="https://github.com/Zhniing" target="_blank">
            Github
        </a>
    
        <!-- <a href="/about.html"  target="_self"> -->
        <a href="/about.html" target="_self">
            About
        </a>
    
        <!-- <a href="/games/hiker"  target="_self"> -->
        <a href="/games/hiker" target="_self">
            Game
        </a>
    
        <!-- <a href="/"  target="_self"> -->
        <a href="/" target="_self">
            Home
        </a>
    
</nav>
      </div>
      <base target="_blank"> <!-- 仅post页面的a标签为_blank -->

<h1>Python类的成员</h1>
<!-- <p>Posted on 04 Aug 2021, Last updated: </p> -->
<!-- <p>发表于 2021 年 08 月 04 日 | 更新于 </p> -->
<p>发布于 2021 年 08 月 04 日  | 更新于 2021 年 08 月 17 日 </p>

<div class="post_content">
    <p>python中所有东西都是对象，传统的变量、函数或者类都可以叫做<em>变量</em>，因此我们用<strong>属性</strong>代指<em>传统的变量</em></p>

<h1 id="类的属性">类的属性</h1>

<h2 id="分类">分类</h2>

<ul>
  <li>
    <p>实例属性</p>

    <p>通过<code class="language-plaintext highlighter-rouge">self.</code>定义的属性</p>

    <p>覆盖同名的类属性</p>
  </li>
  <li>
    <p>类属性</p>

    <p>直接在类命名空间中定义的属性</p>

    <p>通过类名可以访问和修改</p>

    <p>通过对象只能访问，修改实际上是新增一个同名实例属性</p>
  </li>
</ul>

<h1 id="类的方法">类的方法</h1>

<p>分为以下3种</p>

<h2 id="实例方法">实例方法</h2>

<p>至少接收一个位置参数<code class="language-plaintext highlighter-rouge">self</code>（这个self也可以取其他名字，约定俗成self），指向调用该方法的对象</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">self</span><span class="o">=</span><span class="s">'None'</span><span class="p">):</span>  <span class="c1"># 设置默认值，判断是否传入self
</span>    <span class="k">return</span> <span class="n">self</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">f</span> <span class="o">=</span> <span class="n">fun</span>  <span class="c1"># 不在 A 命名空间中，而在 a 命名空间
</span>
    <span class="k">def</span> <span class="nf">inst_m1</span><span class="p">(</span><span class="n">self</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span>

    <span class="n">inst_m2</span> <span class="o">=</span> <span class="n">fun</span>  <span class="c1"># 这样也会变成 method
</span>
<span class="n">a</span> <span class="o">=</span> <span class="nc">A</span><span class="p">()</span>
<span class="n">A</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">fun</span>  <span class="c1"># 任何添加到 A 命名空间函数都会变成 method
</span><span class="nf">print</span><span class="p">(</span><span class="n">fun</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="nf">fun</span><span class="p">())</span>  <span class="c1"># &lt;class 'function'&gt; None
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">f</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="nf">f</span><span class="p">())</span>  <span class="c1"># &lt;class 'function'&gt; None
</span><span class="nf">print</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">m</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="nf">m</span><span class="p">())</span>  <span class="c1"># &lt;class 'function'&gt; None
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">m</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="nf">m</span><span class="p">())</span>
<span class="c1"># &lt;class 'method'&gt; &lt;__main__.A object at 0x7f51dd94d2b0&gt;
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">inst_m1</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="nf">inst_m1</span><span class="p">())</span>
<span class="c1"># &lt;class 'method'&gt; &lt;__main__.A object at 0x7f51dd94d2b0&gt;
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">inst_m2</span><span class="p">.</span><span class="n">__class__</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="nf">inst_m2</span><span class="p">())</span>
<span class="c1"># &lt;class 'method'&gt; &lt;__main__.A object at 0x7f51dd94d2b0&gt;
</span></code></pre></div></div>

<h3 id="分析">分析</h3>

<ol>
  <li>
    <p>什么函数会变成实例方法</p>

    <p><strong>类命名空间</strong>中，指向函数<strong>function</strong>的变量，都会变成实例方法，无论这个函数是何时添加的</p>

    <p>类代码块中<code class="language-plaintext highlighter-rouge">def</code>的函数、直接赋值的函数，通过类名赋值的函数，都是类命名空间中的名字</p>

    <p>但<code class="language-plaintext highlighter-rouge">self.f = fun</code>不是在类命名空间中定义的名字，而是<strong>对象命名空间</strong>（？</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">method</code>和<code class="language-plaintext highlighter-rouge">function</code>的区别 <a href="https://stackoverflow.com/a/155655">ref</a></p>

    <p><code class="language-plaintext highlighter-rouge">method</code>依附于某个对象，会自动（隐式地）传入一个（第一个）位置参数：调用方法的对象本身</p>

    <p><code class="language-plaintext highlighter-rouge">function</code>不会自动传参，所有参数都显式传递</p>
  </li>
</ol>

<h2 id="类方法">类方法</h2>

<p>类或对象都可以调用</p>

<p>至少接收一个位置参数<code class="language-plaintext highlighter-rouge">cls</code>（这个cls也可以取其他名字，约定俗成cls），指向调用该方法的类</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">class_method</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">'class_method, cls is'</span><span class="p">,</span> <span class="n">cls</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="nc">A</span><span class="p">()</span>
<span class="n">a</span><span class="p">.</span><span class="nf">class_method</span><span class="p">()</span>  <span class="c1"># class_method, cls is &lt;class '__main__.A'&gt;
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">class_method</span><span class="p">)</span> <span class="c1"># &lt;bound method A.class_method of &lt;class '__main__.A'&gt;&gt;
</span></code></pre></div></div>

<h2 id="静态方法">静态方法</h2>

<p>类或对象都可以调用</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">static_method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">'static_method'</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="nc">A</span><span class="p">()</span>
<span class="n">a</span><span class="p">.</span><span class="nf">static_method</span><span class="p">()</span>  <span class="c1"># static_method
</span><span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">static_method</span><span class="p">)</span>  <span class="c1"># &lt;function A.static_method at 0x7f600f65adc0&gt;
</span></code></pre></div></div>

<h1 id="总结">总结</h1>

<p><code class="language-plaintext highlighter-rouge">bound method</code>（绑定方法？）都<strong>绑定了</strong>某个<strong>变量</strong>（<code class="language-plaintext highlighter-rouge">... of &lt;object or class&gt;</code>），并且会<strong>自动</strong>（隐式）把这个变量当参数传进去，实例方法绑定一个具体实例对象<code class="language-plaintext highlighter-rouge">self</code>，类方法绑定一个类<code class="language-plaintext highlighter-rouge">cls</code></p>

</div>
    </div>
    <script>
      const ct = document.querySelector('.post_content');  //".post-content"指向文章内容所在的div，需根据实际情况修改
      scrollnav.init(ct, {
          debug: false,
          easingStyle: 'linear',
          //section为一级目录，subsection为二级目录
          sections: ($('.post_content > h1').length>0) ? 'h1' : 'h2',
          subSections: ($('.post_content > h1').length>0) ? 'h2' : 'h3',
      });
    </script>
    <script type="text/javascript">
      $('pre').addClass("line-numbers").css("white-space", "pre-wrap");
    </script>
  </body>
</html>
